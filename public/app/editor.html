<!doctype html> 
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Editor ‚Ä¢ Schedule Builder</title>

  <link rel="stylesheet" href="/public/assets/css/base.css" />
  <link rel="stylesheet" href="/public/assets/css/layout.css" />
  <link rel="stylesheet" href="/public/assets/css/schedule.css" />
  <link rel="stylesheet" href="/public/assets/css/style.css" />
  <link rel="stylesheet" href="/public/assets/css/print.css" media="print" />
</head>
<body class="page page--editor">
  <div class="app-shell">
    <header class="topbar">
      <div class="topbar__left">
        <a class="brand" href="/public/index.html">
          <span class="brand__mark" aria-hidden="true">SB</span>
          <span class="brand__name">Schedule Builder</span>
        </a>
        <span class="crumb">Editor</span>
      </div>

      <!-- Keep existing buttons for existing logic -->
      <div class="topbar__right">
        <button class="btn btn--ghost" id="btnNew" type="button">New</button>
        <button class="btn btn--ghost" id="btnPrint" type="button">Print</button>
        <button class="btn btn--primary" id="btnShare" type="button">Share</button>
      </div>
    </header>

    <main class="workspace">
      <!-- STAGE FIRST (big area) -->
      <section class="stage" aria-label="Schedule Canvas">
        <div class="stage__header">
          <h1 class="stage__title" id="stageTitle">My Schedule</h1>
          <div class="stage__meta muted" id="stageMeta">08:00 ‚Äì 20:00</div>
        </div>

        <div class="schedule" id="scheduleRoot">
          <div class="schedule__grid" id="grid">
            <div class="schedule__axis" id="timeAxis" aria-hidden="true"></div>
            <div class="schedule__days" id="dayHeader" aria-hidden="true"></div>
            <div class="schedule__canvas" id="canvas" role="region" aria-label="Schedule grid"></div>
          </div>
        </div>
      </section>

      <!-- RIGHT ACTION PANEL -->
      <aside class="sidepanel" aria-label="Actions">
        <button class="sidebtn sidebtn--primary" id="sideAdd" type="button">
          <span>Add</span><span class="sidebtn__icon">Ôºã</span>
        </button>

        <button class="sidebtn" id="sideSettings" type="button">
          <span>Settings</span><span class="sidebtn__icon">‚öô</span>
        </button>

        <button class="sidebtn" id="sideBackground" type="button">
          <span>Background</span><span class="sidebtn__icon">üñº</span>
        </button>

        <!-- ‚úÖ removed from UI (kept in DOM to avoid breaking other JS) -->
        <button class="sidebtn" id="sideSelection" type="button" hidden>
          <span>Selection</span><span class="sidebtn__icon">‚úé</span>
        </button>

        <button class="sidebtn" id="sideShare" type="button">
          <span>Share</span><span class="sidebtn__icon">‚Üó</span>
        </button>

        <button class="sidebtn sidebtn--danger" id="sideReset" type="button">
          <span>Reset</span><span class="sidebtn__icon">üßπ</span>
        </button>

        <div class="sidepanel__spacer"></div>

        <div class="sidepanel__mini" aria-label="Quick actions">
          <button class="tilebtn" id="sideNew" type="button" title="New">üóã</button>
          <button class="tilebtn" id="sidePrint" type="button" title="Print">üñ®</button>
          <button class="tilebtn" id="sideQuickShare" type="button" title="Share">‚§¥</button>
        </div>
      </aside>
    </main>
  </div>

  <!-- =========================
       MODALS
       ========================= -->

  <!-- ADD / EDIT EVENT -->
  <div class="modal-overlay" id="modalAdd" hidden>
    <div class="modal modal--light" role="dialog" aria-modal="true" aria-labelledby="modalAddTitle">
      <div class="modal__head modal__head--light">
        <div class="modal__title modal__title--light" id="modalAddTitle">
          <span class="modal__icon" aria-hidden="true">üìÖ</span>
          <span id="modalAddHeadingText">Add event</span>
        </div>
        <button class="iconbtn iconbtn--light" type="button" data-modal-close aria-label="Close">√ó</button>
      </div>

      <div class="modal__body modal__body--light">
        <div class="sb-form">

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üè∑</div>
            <div class="sb-field">
              <div class="sb-label">Title</div>
              <input class="sb-input" id="blockText" name="blockText" type="text" placeholder="Class / Work / Gym" />
            </div>
            <button class="sb-miniBtn" type="button" id="sbAutoColorBtn" title="Auto color">üé®</button>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üìÜ</div>
            <div class="sb-field">
              <div class="sb-label">Day(s)</div>
              <div class="sb-days" id="sbAddDays" role="group" aria-label="Pick day">
                <button class="sb-day" type="button" data-day="0">Mon</button>
                <button class="sb-day" type="button" data-day="1">Tue</button>
                <button class="sb-day" type="button" data-day="2">Wed</button>
                <button class="sb-day" type="button" data-day="3">Thu</button>
                <button class="sb-day" type="button" data-day="4">Fri</button>
                <button class="sb-day" type="button" data-day="5">Sat</button>
                <button class="sb-day" type="button" data-day="6">Sun</button>
              </div>
              <div class="sb-hint">Tip: select a day here, then click the grid to place it (still works with your current ‚Äúpick day on grid‚Äù flow).</div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">‚è≥</div>
            <div class="sb-field">
              <div class="sb-label">Start time - End time</div>
              <div class="sb-two">
                <input class="sb-input" id="taskStartTime" name="taskStartTime" type="time" value="09:00" />
                <input class="sb-input" id="taskEndTime" name="taskEndTime" type="time" value="10:00" />
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">‚Ñπ</div>
            <div class="sb-field">
              <div class="sb-label">Description</div>
              <textarea class="sb-textarea" id="sbDesc" placeholder=""></textarea>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üé®</div>
            <div class="sb-field">
              <div class="sb-label">Color</div>
              <input class="sb-input sb-input--color" id="blockColor" name="blockColor" type="color" value="#4f46e5" />
            </div>
          </div>

          <div class="sb-actions">
            <!-- ‚úÖ Hidden in Add mode; shown only in Edit mode -->
            <button class="sb-btn sb-btn--ghost" id="sbCopySelection" type="button" hidden>Copy</button>

            <!-- ‚úÖ Only for Edit mode -->
            <button class="sb-btn sb-btn--danger" id="btnDeleteBlock" type="button" hidden>Delete</button>

            <button class="sb-btn sb-btn--primary" id="btnAddBlock" type="button">Add</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SETTINGS -->
  <div class="modal-overlay" id="modalSettings" hidden>
    <div class="modal modal--light" role="dialog" aria-modal="true" aria-labelledby="modalSettingsTitle">
      <div class="modal__head modal__head--light">
        <div class="modal__title modal__title--light" id="modalSettingsTitle">
          <span class="modal__icon" aria-hidden="true">üóì</span>
          Schedule settings
        </div>
        <button class="iconbtn iconbtn--light" type="button" data-modal-close aria-label="Close">√ó</button>
      </div>

      <div class="modal__body modal__body--light">
        <div class="sb-tabs" role="tablist" aria-label="Settings tabs">
          <button class="sb-tab is-active" type="button" role="tab" aria-selected="true" data-tab="layout">Layout</button>
          <button class="sb-tab" type="button" role="tab" aria-selected="false" data-tab="time">Time</button>
          <button class="sb-tab" type="button" role="tab" aria-selected="false" data-tab="event">Event</button>
          <button class="sb-tab" type="button" role="tab" aria-selected="false" data-tab="font">Font</button>
        </div>

        <div class="sb-panel is-active" data-panel="layout" role="tabpanel">
          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üè∑</div>
            <div class="sb-field">
              <div class="sb-label">Show title</div>
              <div class="sb-seg" data-setting="showTitle">
                <button type="button" class="sb-segBtn is-active" data-value="yes">Yes</button>
                <button type="button" class="sb-segBtn" data-value="no">No</button>
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üìÜ</div>
            <div class="sb-field">
              <div class="sb-label">Day(s)</div>
              <div class="sb-days" id="sbLayoutDays" role="group" aria-label="Visible days">
                <button class="sb-day is-on" type="button" data-day="0" disabled>Mon</button>
                <button class="sb-day is-on" type="button" data-day="1" disabled>Tue</button>
                <button class="sb-day is-on" type="button" data-day="2" disabled>Wed</button>
                <button class="sb-day is-on" type="button" data-day="3" disabled>Thu</button>
                <button class="sb-day is-on" type="button" data-day="4" disabled>Fri</button>
                <button class="sb-day is-on" type="button" data-day="5" id="sbSat">Sat</button>
                <button class="sb-day is-on" type="button" data-day="6" id="sbSun">Sun</button>
              </div>
              <label class="sb-hiddenCheck">
                <input id="showWeekend" name="showWeekend" type="checkbox" checked />
                <span>Show weekend</span>
              </label>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üóì</div>
            <div class="sb-field">
              <div class="sb-label">Show dates</div>
              <div class="sb-seg" data-setting="showDates">
                <button type="button" class="sb-segBtn is-active" data-value="yes">Yes</button>
                <button type="button" class="sb-segBtn" data-value="no">No</button>
              </div>

              <div class="sb-weekRow">
                <div class="sb-weekLabel" id="sbWeekLabel">This week</div>
                <input class="sb-input" id="sbWeek" type="week" />
              </div>
            </div>
          </div>

          <button class="sb-btn sb-btn--outline" type="button" id="sbSettingsCloseA">Update</button>
        </div>

        <div class="sb-panel" data-panel="time" role="tabpanel">
          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üïí</div>
            <div class="sb-field">
              <div class="sb-label">Clock type</div>
              <div class="sb-seg" data-setting="clockMode">
                <button type="button" class="sb-segBtn" data-value="12">12-Hour</button>
                <button type="button" class="sb-segBtn is-active" data-value="24">24-Hour</button>
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">‚â°</div>
            <div class="sb-field">
              <div class="sb-label">Line spacing (minutes)</div>
              <div class="sb-seg" data-setting="minuteStep">
                <button type="button" class="sb-segBtn is-active" data-value="15">15</button>
                <button type="button" class="sb-segBtn" data-value="30">30</button>
                <button type="button" class="sb-segBtn" data-value="60">60</button>
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üìè</div>
            <div class="sb-field">
              <div class="sb-label">Start hour - End hour</div>
              <div class="sb-two">
                <input class="sb-input" id="sbStartHour" type="number" min="0" max="23" step="1" value="8" />
                <input class="sb-input" id="sbEndHour" type="number" min="0" max="23" step="1" value="20" />
              </div>

              <div class="sb-hidden">
                <input class="input" id="startTime" name="startTime" type="time" value="08:00" />
                <input class="input" id="endTime" name="endTime" type="time" value="20:00" />
              </div>
            </div>
          </div>

          <button class="sb-btn sb-btn--outline" type="button" id="sbSettingsCloseB">Update</button>
        </div>

        <div class="sb-panel" data-panel="event" role="tabpanel">
          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üé®</div>
            <div class="sb-field">
              <div class="sb-label">Auto select color</div>
              <div class="sb-seg" data-setting="autoColor">
                <button type="button" class="sb-segBtn is-active" data-value="yes">Yes</button>
                <button type="button" class="sb-segBtn" data-value="no">No</button>
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">‚è≥</div>
            <div class="sb-field">
              <div class="sb-label">Show time in events</div>
              <div class="sb-seg" data-setting="showTimeInEvents">
                <button type="button" class="sb-segBtn is-active" data-value="yes">Yes</button>
                <button type="button" class="sb-segBtn" data-value="no">No</button>
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">‚Üï</div>
            <div class="sb-field">
              <div class="sb-label">Stretch to fit content</div>
              <div class="sb-seg" data-setting="stretchText">
                <button type="button" class="sb-segBtn is-active" data-value="yes">Yes</button>
                <button type="button" class="sb-segBtn" data-value="no">No</button>
              </div>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">‚â°</div>
            <div class="sb-field">
              <div class="sb-label">Center text</div>
              <div class="sb-seg" data-setting="centerText">
                <button type="button" class="sb-segBtn is-active" data-value="yes">Yes</button>
                <button type="button" class="sb-segBtn" data-value="no">No</button>
              </div>
            </div>
          </div>

          <button class="sb-btn sb-btn--outline" type="button" id="sbSettingsCloseC">Update</button>
        </div>

        <div class="sb-panel" data-panel="font" role="tabpanel">
          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">A</div>
            <div class="sb-field">
              <div class="sb-label">Text font</div>
              <select class="sb-input" id="sbFont">
                <option value='system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif'>System</option>
                <option value='Roboto, system-ui, -apple-system, Segoe UI, Arial, sans-serif'>Roboto</option>
                <option value='Georgia, "Times New Roman", serif'>Serif</option>
                <option value='"Trebuchet MS", system-ui, -apple-system, Segoe UI, Arial, sans-serif'>Trebuchet</option>
                <option value='"Courier New", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace'>Mono</option>
              </select>
            </div>
          </div>

          <div class="sb-row">
            <div class="sb-leftIcon" aria-hidden="true">üé®</div>
            <div class="sb-field">
              <div class="sb-label">Text color</div>
              <input class="sb-input sb-input--colorWide" id="sbEventTextColor" type="color" value="#1b1f2a" />
            </div>
          </div>

          <div class="sb-hidden">
            <input class="input" id="scheduleTitle" name="scheduleTitle" type="text" placeholder="My Schedule" />
          </div>

          <button class="sb-btn sb-btn--outline" type="button" id="sbSettingsCloseD">Update</button>
        </div>
      </div>
    </div>
  </div>

  <!-- THEME / BACKGROUND -->
  <div class="modal-overlay" id="modalTheme" hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalThemeTitle">
      <div class="modal__head">
        <div class="modal__title" id="modalThemeTitle">Background & Theme</div>
        <button class="iconbtn" type="button" data-modal-close aria-label="Close">√ó</button>
      </div>
      <div class="modal__body">
        <div class="modal__card">
          <div class="panel__section panel__section--collapsible" id="themeSettings" style="margin:0;">
            <button class="panel__toggle" id="themeToggle" type="button" aria-expanded="false" aria-controls="themeBody">
              <span class="panel__toggleTitle">Theme</span>
              <span class="panel__chev" aria-hidden="true"></span>
            </button>

            <div class="panel__body" id="themeBody" hidden>
              <div class="btn-row" style="margin-top: 12px;">
                <button class="btn btn--ghost" id="btnThemeDark" type="button">Dark</button>
                <button class="btn btn--ghost" id="btnThemeLight" type="button">Light</button>
                <button class="btn btn--ghost" id="btnThemeOcean" type="button">Ocean</button>
              </div>

              <div class="field-row">
                <label class="field">
                  <span class="field__label">Background</span>
                  <input class="input input--color" type="color" data-theme-var="--bg" />
                </label>

                <label class="field">
                  <span class="field__label">Text</span>
                  <input class="input input--color" type="color" data-theme-var="--text" />
                </label>
              </div>

              <div class="field-row">
                <label class="field">
                  <span class="field__label">Panel</span>
                  <input class="input input--color" type="color" data-theme-var="--panel" />
                </label>

                <label class="field">
                  <span class="field__label">Card</span>
                  <input class="input input--color" type="color" data-theme-var="--card" />
                </label>
              </div>

              <div class="field-row">
                <label class="field">
                  <span class="field__label">Muted</span>
                  <input class="input input--color" type="color" data-theme-var="--muted" />
                </label>

                <label class="field">
                  <span class="field__label">Brand</span>
                  <input class="input input--color" type="color" data-theme-var="--brand" />
                </label>
              </div>

              <div class="field-row">
                <label class="field">
                  <span class="field__label">Accent</span>
                  <input class="input input--color" type="color" data-theme-var="--brand2" />
                </label>

                <label class="field">
                  <span class="field__label">Danger</span>
                  <input class="input input--color" type="color" data-theme-var="--danger" />
                </label>
              </div>

              <button class="btn btn--danger btn--full" id="btnThemeReset" type="button">
                Reset theme
              </button>

              <p class="muted small" style="margin: 10px 0 0;">
                Theme settings are saved automatically in your browser.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SELECTION -->
  <div class="modal-overlay" id="modalSelection" hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalSelectionTitle">
      <div class="modal__head">
        <div class="modal__title" id="modalSelectionTitle">Selection</div>
        <button class="iconbtn" type="button" data-modal-close aria-label="Close">√ó</button>
      </div>
      <div class="modal__body">
        <div class="modal__card modal__grid">
          <div class="muted small" id="selectionHint">
            Select a block to edit its details.
          </div>

          <label class="field" for="selectedText">
            <span class="field__label">Selected text</span>
            <input class="input" id="selectedText" name="selectedText" type="text" placeholder="‚Äî" disabled />
          </label>

          <div class="btn-row">
            <button class="btn btn--ghost" id="btnDuplicate" type="button" disabled>Duplicate</button>
            <button class="btn btn--danger" id="btnDelete" type="button" disabled>Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- RESET -->
  <div class="modal-overlay" id="modalReset" hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalResetTitle">
      <div class="modal__head">
        <div class="modal__title" id="modalResetTitle">Reset</div>
        <button class="iconbtn" type="button" data-modal-close aria-label="Close">√ó</button>
      </div>
      <div class="modal__body">
        <div class="modal__card modal__grid">
          <p class="muted" style="margin:0;">
            Choose what you want to reset.
          </p>

          <div class="btn-row">
            <button class="btn btn--danger" id="resetNewSchedule" type="button">New schedule</button>
            <button class="btn btn--ghost" id="resetThemeOnly" type="button">Reset theme</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚úÖ SHARE -->
  <div class="modal-overlay" id="modalShare" hidden>
    <div class="modal modal--light share-modal" role="dialog" aria-modal="true" aria-labelledby="modalShareTitle">
      <div class="modal__head modal__head--light">
        <div class="modal__title modal__title--light" id="modalShareTitle">
          <span class="modal__icon" aria-hidden="true">‚Üó</span>
          Share schedule
        </div>
        <button class="iconbtn iconbtn--light" type="button" data-modal-close aria-label="Close">√ó</button>
      </div>

      <div class="modal__body modal__body--light">
        <div class="share-tabs" role="tablist" aria-label="Share tabs">
          <button class="share-tab is-active" type="button" role="tab" aria-selected="true" data-tab="share">Share</button>
          <button class="share-tab" type="button" role="tab" aria-selected="false" data-tab="links">My links</button>
        </div>

        <div class="share-panel is-active" data-panel="share" role="tabpanel">
          <button class="share-card" id="shareCreateLink" type="button">
            <span>Create direct link</span>
            <span class="share-card__icon" aria-hidden="true">‚Üó</span>
          </button>

          <button class="share-card" id="shareGetEmbed" type="button">
            <span>Get Embed code</span>
            <span class="share-card__icon" aria-hidden="true">&lt;/&gt;</span>
          </button>

          <div class="share-status muted" id="shareStatus" aria-live="polite"></div>

          <div class="share-result" id="shareResult" hidden>
            <div class="share-label">Direct link</div>
            <div class="share-row">
              <input class="share-input" id="shareDirectInput" type="text" readonly />
              <button class="share-btn" id="shareCopyDirect" type="button" title="Copy">Copy</button>
              <a class="share-btn share-btn--icon" id="shareOpenDirect" href="#" target="_blank" rel="noopener" title="Open">‚Üó</a>
            </div>
          </div>

          <div class="share-embed" id="shareEmbed" hidden>
            <div class="share-label">Embed code</div>
            <textarea class="share-textarea" id="shareEmbedTextarea" rows="4" readonly></textarea>
            <div class="share-actions-row">
              <button class="share-btn" id="shareCopyEmbed" type="button">Copy</button>
              <a class="share-btn share-btn--icon" id="shareOpenEmbed" href="#" target="_blank" rel="noopener" title="Open embed page">‚Üó</a>
            </div>
          </div>

          <div class="share-hint muted small">
            Note: sharing works only when the site is served through PHP (hosting/Apache). A plain static server cannot run <code>server/api/*.php</code>.
          </div>
        </div>

        <div class="share-panel" data-panel="links" role="tabpanel">
          <div class="share-links" id="shareLinksList"></div>
          <div class="share-empty muted" id="shareLinksEmpty">No shared links yet.</div>
        </div>
      </div>
    </div>
  </div>

  <noscript>
    <div class="noscript-banner">
      The editor requires JavaScript enabled.
    </div>
  </noscript>

  <script type="module" src="/public/assets/js/main.js"></script>
</body>
</html>
